<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="p:domain_verify" content="83c56765f65f35292560ce47a746603c"/>
    <title>Odia Bhasa App Photos - Gallery | Kids Learning App</title>
    <meta name="description" content="A beautiful gallery of photos related to the Odia Bhasa App, a kids learning app showcasing the rich culture, heritage, and beauty of Odisha.">
    <meta name="author" content="Sandeep Biswal G">
    <meta name="keywords" content="Odia, Bhasa, App, Odisha, Photos, Gallery, Culture, Heritage, Kids Learning, Odia Alphabet, Odia Language">
    <link rel="canonical" href="http://imsbg.github.io/Odia-Bhasa-App-Photos/">
    
    <!-- Open Graph / Facebook (For Link Previews) -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://imsbg.github.io/Odia-Bhasa-App-Photos/">
    <meta property="og:title" content="Odia Bhasa App Photos - Gallery">
    <meta property="og:description" content="A beautiful gallery of photos related to the Odia Bhasa App, a kids learning app.">
    <meta property="og:image" content="https://imsbg.github.io/Odia-Bhasa-App-Photos/img/banner.png">

    <!-- Twitter (For Link Previews) -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="http://imsbg.github.io/Odia-Bhasa-App-Photos/">
    <meta property="twitter:title" content="Odia Bhasa App Photos - Gallery">
    <meta property="twitter:description" content="A beautiful gallery of photos related to the Odia Bhasa App, a kids learning app.">
    <meta property="twitter:image" content="https://imsbg.github.io/Odia-Bhasa-App-Photos/img/banner.png">
    
    <style>
        :root {
            --primary-color: #00bfff;
            --background-color: #000000;
            --text-color: #e0e0e0;
            --header-bg: rgba(20, 20, 20, 0.35);
            --card-bg: #1a1a1a;
            --border-radius: 12px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            user-select: none;
            -webkit-user-select: none;
        }
        body.modal-open { overflow: hidden; }

        .site-background-container { position: fixed; inset: 0; z-index: -1; }
        .site-background {
            position: absolute; inset: 0;
            background-size: cover; background-position: center;
            filter: blur(50px) brightness(0.5); transform: scale(1.2);
            transition: opacity 1.5s ease-in-out;
            opacity: 0;
            mask-image: linear-gradient(to bottom, black 0%, black 80%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 0%, black 80%, transparent 100%);
        }
        .site-background.active { opacity: 1; }

        /* --- Header --- */
        .site-header {
            background: var(--header-bg);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            position: sticky;
            top: 1rem;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            border-radius: 50px;
            padding: 0.5rem 1rem 0.5rem 0.75rem;
            margin: 1rem auto;
            max-width: 95%;
            width: fit-content;
            transition: all 0.3s ease;
        }
        .header-content {
            display: flex;
            align-items: center;
            text-decoration: none;
        }
        .header-app-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            margin-right: 12px;
        }
        .site-title { font-size: 1.5rem; font-weight: 600; color: #fff; }
        .desktop-nav { display: none; } /* Hidden on mobile by default */
        
        main { padding: 2rem 5%; position: relative; z-index: 1; }
        .gallery-intro {
            text-align: center;
            max-width: 650px;
            margin: 1rem auto 2.5rem auto;
            color: #bbb;
            line-height: 1.7;
            font-size: 1rem;
        }
        h2 { text-align: center; margin-bottom: 2rem; color: #fff; font-weight: 600; }

        /* Gallery */
        .gallery-grid { column-count: 3; column-gap: 1.5rem; }
        .gallery-item { margin-bottom: 1.5rem; break-inside: avoid; cursor: pointer; border-radius: var(--border-radius); background: var(--card-bg); transition: transform 0.3s ease, box-shadow 0.3s ease; display: inline-block; width: 100%; }
        .gallery-item:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0, 191, 255, 0.2); }
        .gallery-item img { width: 100%; height: auto; display: block; border-radius: var(--border-radius) var(--border-radius) 0 0; }
        .gallery-item .info { padding: 1rem; }
        .gallery-item .info h3 { font-size: 1.1rem; margin-bottom: 0.25rem; color: #fff; }
        .gallery-item .info p { font-size: 0.9rem; color: #aaa; }
        
        /* --- Footer --- */
        .site-footer {
            margin-top: 4rem;
            padding: 2rem 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }
        .app-card {
            display: flex; flex-direction: column; align-items: center; text-align: center;
            background: linear-gradient(145deg, rgba(30, 30, 30, 0.5), rgba(45, 45, 45, 0.5));
            border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 20px;
            padding: 1.5rem; width: 90%; max-width: 380px;
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
        }
        .app-card .app-logo { width: 80px; height: 80px; border-radius: 18px; margin-bottom: 1rem; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .app-card h3 { color: #fff; font-size: 1.3rem; font-weight: 600; margin-bottom: 0.5rem; }
        .app-card p { color: var(--text-color); font-size: 0.9rem; margin-bottom: 1.5rem; line-height: 1.5; }
        .app-card .download-btn { display: block; width: 150px; height: auto; transition: transform 0.2s ease; }
        .app-card .download-btn:hover { transform: scale(1.05); }
        .app-card .download-btn img { width: 100%; height: auto; }
        .footer-nav ul { list-style: none; display: flex; flex-wrap: wrap; justify-content: center; gap: 1rem 2rem; padding: 0; }
        .footer-nav a { color: #aaa; text-decoration: none; transition: color 0.3s ease; }
        .footer-nav a:hover { color: #fff; }

        /* --- Refined Lightbox --- */
        .lightbox { position: fixed; inset: 0; background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(5px); -webkit-backdrop-filter: blur(5px); display: none; z-index: 1000; }
        .lightbox.active { display: block; }
        .lightbox-content { width: 100%; height: 100%; overflow-y: auto; overflow-x: hidden; -webkit-overflow-scrolling: touch; }
        .lightbox-image-container { display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        .lightbox-image { display: block; max-width: 95vw; max-height: 90vh; transition: all 0.5s cubic-bezier(0.25, 0.8, 0.25, 1); box-shadow: 0 25px 50px rgba(0,0,0,0.5); cursor: grab; }
        .lightbox-image.zoomed { cursor: move; }
        .lightbox-details-panel { background: #fff; color: #333; padding: 2rem; border-radius: 20px 20px 0 0; transform: translateY(100%); transition: transform 0.5s cubic-bezier(0.25, 0.8, 0.25, 1); }
        .lightbox-details-panel h3 { font-size: 2rem; margin-bottom: 1rem; color: #111; }
        .lightbox-details-panel p { margin-bottom: 2rem; line-height: 1.7; font-size: 1.1rem; white-space: pre-wrap; }
        .meta-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; }
        .meta-grid div { color: #555; }
        .meta-grid span { font-weight: bold; color: #111; display: block; margin-bottom: 0.25rem; }
        .source-link, .share-button { display: block; background: #222; color: #fff; text-decoration: none; padding: 1rem 1.5rem; border-radius: 8px; font-weight: bold; text-align: center; margin-top: 1rem; transition: transform 0.2s ease, background-color 0.2s ease; cursor: pointer; border: none; font-size: 1rem; width: 100%; }
        .source-link:hover, .share-button:hover { transform: scale(1.02); background-color: #000; }
        .share-button { background-color: var(--primary-color); display: flex; justify-content: center; align-items: center; gap: 0.5rem; }
        .share-button svg { width: 20px; height: 20px; fill: white; }
        .lightbox.details-view-active .lightbox-image { transform: scale(0.9); border-radius: var(--border-radius); max-height: 80vh; }
        .lightbox.details-view-active .lightbox-image-container { min-height: 90vh; }
        .lightbox.details-view-active .lightbox-details-panel { transform: translateY(0); }
        .lightbox-button { position: fixed; background: rgba(20, 20, 20, 0.5); border: none; color: #fff; font-size: 2.5rem; cursor: pointer; padding: 0.5rem; transition: all 0.3s ease; user-select: none; backdrop-filter: blur(5px); z-index: 1001;}
        .lightbox-close { top: 15px; right: 15px; line-height: 1; padding: 0.5rem 1rem; border-radius: 50%; }
        .lightbox-next, .lightbox-prev { top: 50%; transform: translateY(-50%); border-radius: 5px; }
        .lightbox-next { right: 15px; } .lightbox-prev { left: 15px; }
        .lightbox.details-view-active .lightbox-next, .lightbox.details-view-active .lightbox-prev { opacity: 0; pointer-events: none; }
        .lightbox-zoom-container { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); display: flex; flex-direction: column; align-items: center; gap: 10px; background: rgba(20,20,20,0.5); backdrop-filter: blur(5px); border-radius: 8px; z-index: 1001; transition: opacity 0.4s ease, transform 0.4s ease; padding: 0.5rem; }
        .lightbox-zoom-controls { display: flex; }
        .lightbox-zoom-controls button { background: none; border: none; color: #fff; font-size: 1.5rem; padding: 0.25rem 0.75rem; cursor: pointer; }
        #zoom-slider { width: 150px; accent-color: var(--primary-color); }
        .lightbox.details-view-active .lightbox-zoom-container { opacity: 0; pointer-events: none; transform: translate(-50%, 20px); }
        .minimap-container { position: fixed; top: 20px; right: 80px; width: 150px; height: 100px; border: 2px solid rgba(255,255,255,0.7); background: #000; z-index: 1002; overflow: hidden; display: none; cursor: crosshair; }
        .minimap-img { width: 100%; height: 100%; object-fit: contain; pointer-events: none; }
        .minimap-viewport { position: absolute; border: 1px solid var(--primary-color); background: rgba(0, 191, 255, 0.3); pointer-events: none; }

        /* Responsive */
        @media (max-width: 1024px) { .gallery-grid { column-count: 2; } }
        
        @media (min-width: 769px) {
            .desktop-nav {
                display: flex;
                align-items: center;
                gap: 0.5rem;
            }
            .desktop-nav ul {
                list-style: none;
                display: flex;
                gap: 0.5rem;
                align-items: center;
            }
            .desktop-nav a {
                color: var(--text-color); text-decoration: none;
                font-weight: 500; transition: all 0.3s ease;
                padding: 0.5rem 1rem; border-radius: 30px;
            }
            .desktop-nav a:hover { color: #fff; background: rgba(255, 255, 255, 0.1); }
            .site-header { padding-right: 1.5rem; } /* Restore padding when nav is present */
            .footer-nav { display: none; } /* Hide footer links on desktop */
        }
        
        @media (max-width: 768px) {
            .gallery-grid { column-count: 1; }
            .minimap-container { display: none !important; }
            .lightbox-details-panel h3 { font-size: 1.5rem; }
            .lightbox-details-panel p { font-size: 1rem; }
            .site-title { font-size: 1.2rem; }
        }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="site-background-container">
        <div id="site-background" class="site-background"></div>
    </div>

    <header class="site-header">
        <a href="https://imsbg.github.io/odiabhasa/" class="header-content">
            <img src="https://imsbg.github.io/odiabhasa/images/app.png" alt="Odia Bhasa App Icon" class="header-app-icon">
            <span class="site-title">Odia Bhasa App</span>
        </a>
        <nav class="desktop-nav">
             <ul>
                <li><a href="https://imsbg.github.io/odiabhasa/">Main Website</a></li>
                <li><a href="https://imsbg.github.io/odiabhasa/privacy-policy?od=">Privacy Policy</a></li>
                <li><a href="https://imsbg.github.io/odiabhasa/terms?od=">Terms & Conditions</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section id="gallery-section">
            <p class="gallery-intro">On this page, you will find a complete collection of images related to the Odia Bhasa App, from the official app banner to all our social media posts.</p>
            <h2>Image Gallery</h2>
            <div class="gallery-grid" id="gallery-grid"></div>
        </section>
    </main>

    <footer class="site-footer">
        <div class="app-card">
            <img src="https://imsbg.github.io/odiabhasa/images/app.png" alt="Odia Bhasa App Logo" class="app-logo">
            <h3>Odia Bhasa App</h3>
            <p>Letâ€™s come together and build the future of our mother tongue.</p>
            <a href="https://play.google.com/store/apps/details?id=in.sandeep.odiabhasa" class="download-btn" target="_blank" rel="noopener noreferrer">
                <img src="https://imsbg.github.io/Odia-Bhasa-App-Photos/img/google-play-badge-logo-svgrepo-com.svg" alt="Get it on Google Play">
            </a>
        </div>
        <nav class="footer-nav">
            <ul>
               <li><a href="https://imsbg.github.io/odiabhasa/">Main Website</a></li>
               <li><a href="https://imsbg.github.io/odiabhasa/privacy-policy?od=">Privacy Policy</a></li>
               <li><a href="https://imsbg.github.io/odiabhasa/terms?od=">Terms & Conditions</a></li>
           </ul>
       </nav>
    </footer>

    <div class="lightbox" id="lightbox"></div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- Element Selection ---
        const siteBackground = document.getElementById('site-background');
        const galleryGrid = document.getElementById('gallery-grid');
        const lightboxEl = document.getElementById('lightbox');
        
        // --- State Variables ---
        let allImages = [];
        const originalTitle = document.title; // --- ADDED: Store original title

        // --- Dynamic Population ---
        function populateStaticContent() {
            lightboxEl.innerHTML = `
                <div class="lightbox-content" id="lightbox-content">
                    <div class="lightbox-image-container"><img src="" alt="" class="lightbox-image" id="lightbox-image"></div>
                    <div class="lightbox-details-panel">
                        <h3 id="lightbox-title"></h3><p id="lightbox-description"></p>
                        <div class="meta-grid" id="lightbox-meta"></div>
                        <a href="#" id="lightbox-source-link" class="source-link" target="_blank" rel="noopener noreferrer">View Original Post</a>
                        <button id="share-button" class="share-button">
                            <svg viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 8.81C7.5 8.31 6.79 8 6 8c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92-1.31-2.92-2.92-2.92z"/></svg>
                            Share Image
                        </button>
                    </div>
                </div>
                <button class="lightbox-button lightbox-close">&times;</button>
                <button class="lightbox-button lightbox-prev">&lt;</button>
                <button class="lightbox-button lightbox-next">&gt;</button>
                <div class="lightbox-zoom-container">
                    <input type="range" id="zoom-slider" min="1" max="5" step="0.1" value="1">
                    <div class="lightbox-zoom-controls"><button id="zoom-out">-</button><button id="zoom-in">+</button></div>
                </div>
                <div class="minimap-container" id="minimap-container">
                    <img src="" id="minimap-img" class="minimap-img" alt="Minimap">
                    <div class="minimap-viewport" id="minimap-viewport"></div>
                </div>`;
        }
        
        // --- Data Fetching & Initial Setup ---
        populateStaticContent();
        fetch('images.json').then(res => {
            if (!res.ok) throw new Error(`HTTP error! status: ${res.status}`);
            return res.json();
        }).then(data => {
            allImages = data;
            
            if (allImages.length > 0) {
                siteBackground.style.backgroundImage = `url(${allImages[0].url})`;
                siteBackground.classList.add('active');
            }

            populateGallery();
            setupLightboxListeners();
            checkUrlForImage();
        }).catch(error => {
            console.error('Error loading or parsing images.json:', error);
            galleryGrid.innerHTML = `<p style="text-align:center; color: #ff8a8a;">Could not load image gallery. Please check if 'images.json' exists and is formatted correctly.</p>`;
        });
        
        // --- Gallery Population ---
        const populateGallery = () => {
            galleryGrid.innerHTML = allImages.map((img, index) => `
                <div class="gallery-item" data-index="${index}">
                    <img src="${img.url}" alt="${img.title}" loading="lazy">
                    <div class="info"><h3>${img.title}</h3><p>${img.smalltext}</p></div>
                </div>`).join('');
            document.querySelectorAll('.gallery-item').forEach(item => {
                item.addEventListener('click', () => openLightbox(parseInt(item.dataset.index)));
            });
        };

        // --- Lightbox Logic ---
        let currentLightboxIndex = 0, scale = 1, isDragging = false, startPos = {x:0, y:0}, translatePos = {x:0, y:0};
        
        const openLightbox = (index) => {
            if (index >= 0 && index < allImages.length) {
                currentLightboxIndex = index;
                updateLightboxContent();
                lightboxEl.classList.add('active');
                document.body.classList.add('modal-open');
            }
        };

        const closeLightbox = () => {
            lightboxEl.classList.remove('active');
            document.body.classList.remove('modal-open');
            resetZoomAndPan();
            // --- MODIFIED: Clean up URL and restore original title ---
            if (history.pushState) {
                const cleanUrl = window.location.protocol + "//" + window.location.host + window.location.pathname;
                window.history.pushState({path:cleanUrl},'',cleanUrl);
                document.title = originalTitle;
                // You could also restore original meta tags here if needed, but it's less critical
            }
        };

        // --- ADDED: Function to update meta tags and browser history ---
        const updateMetaAndHistory = (imgData) => {
            const newUrl = `${window.location.protocol}//${window.location.host}${window.location.pathname}?img=${currentLightboxIndex}`;
            const newTitle = `${imgData.title} | Odia Bhasa App Photos`;

            // Update browser history and URL bar without reloading
            if (history.pushState) {
                window.history.pushState({path: newUrl}, '', newUrl);
            }

            // Update page title
            document.title = newTitle;

            // Update meta tags for SEO and social sharing (won't affect crawlers on initial load)
            document.querySelector('meta[property="og:title"]').setAttribute('content', imgData.title);
            document.querySelector('meta[property="twitter:title"]').setAttribute('content', imgData.title);
            
            const description = imgData.smalltext || imgData.description.substring(0, 150);
            document.querySelector('meta[name="description"]').setAttribute('content', description);
            document.querySelector('meta[property="og:description"]').setAttribute('content', description);
            document.querySelector('meta[property="twitter:description"]').setAttribute('content', description);

            document.querySelector('meta[property="og:image"]').setAttribute('content', imgData.url);
            document.querySelector('meta[property="twitter:image"]').setAttribute('content', imgData.url);
            
            document.querySelector('meta[property="og:url"]').setAttribute('content', newUrl);
            document.querySelector('meta[property="twitter:url"]').setAttribute('content', newUrl);
            document.querySelector('link[rel="canonical"]').setAttribute('href', newUrl);
        };
        
        const updateLightboxContent = () => {
            const imgData = allImages[currentLightboxIndex];
            const lightboxImage = document.getElementById('lightbox-image'), minimapImg = document.getElementById('minimap-img');
            lightboxImage.src = imgData.url; minimapImg.src = imgData.url;
            lightboxImage.alt = imgData.title;

            document.getElementById('lightbox-title').textContent = imgData.title;
            document.getElementById('lightbox-description').textContent = imgData.description;
            document.getElementById('lightbox-meta').innerHTML = [
                imgData.credit ? `<div><span>Credit</span>${imgData.credit}</div>` : '',
                imgData.location ? `<div><span>Location</span>${imgData.location}</div>` : '',
                imgData.captured_on ? `<div><span>Captured</span>${imgData.captured_on}</div>` : '',
                imgData.edited_by ? `<div><span>Edited By</span>${imgData.edited_by}</div>` : '',
            ].join('');
            
            const sourceLink = document.getElementById('lightbox-source-link');
            sourceLink.style.display = imgData.source_url ? 'block' : 'none';
            if(imgData.source_url) sourceLink.href = imgData.source_url;

            document.getElementById('share-button').onclick = async () => {
                const shareUrl = `${window.location.origin}${window.location.pathname}?img=${currentLightboxIndex}`;
                const shareData = { title: imgData.title, text: imgData.smalltext, url: shareUrl };

                if (navigator.share) {
                    try { await navigator.share(shareData); } catch (err) { console.error("Share failed:", err); }
                } else {
                    navigator.clipboard.writeText(shareUrl).then(() => {
                        alert('Share link copied to clipboard!');
                    }).catch(err => {
                        console.error('Failed to copy text: ', err); alert('Could not copy link.');
                    });
                }
            };
            
            lightboxEl.classList.remove('details-view-active');
            document.getElementById('lightbox-content').scrollTop = 0;
            resetZoomAndPan();
            updateMetaAndHistory(imgData); // --- ADDED: Call the function to update everything
        };
        
        const checkUrlForImage = () => {
            const params = new URLSearchParams(window.location.search);
            const imgId = params.get('img');
            if (imgId !== null) {
                const index = parseInt(imgId);
                if (!isNaN(index) && index < allImages.length) openLightbox(index);
            }
        };

        const showNextImage = () => { currentLightboxIndex = (currentLightboxIndex + 1) % allImages.length; updateLightboxContent(); };
        const showPrevImage = () => { currentLightboxIndex = (currentLightboxIndex - 1 + allImages.length) % allImages.length; updateLightboxContent(); };

        const resetZoomAndPan = () => {
            scale = 1; translatePos = { x: 0, y: 0 };
            document.getElementById('zoom-slider').value = 1;
            applyTransform();
            document.getElementById('lightbox-image').classList.remove('zoomed');
            document.getElementById('minimap-container').style.display = 'none';
        };

        const applyTransform = () => {
            document.getElementById('lightbox-image').style.transform = `translate(${translatePos.x}px, ${translatePos.y}px) scale(${scale})`;
            updateMinimap();
        };

        const updateZoom = (newScale) => {
            scale = Math.max(1, Math.min(5, newScale));
            document.getElementById('zoom-slider').value = scale;
            if (scale > 1) { document.getElementById('lightbox-image').classList.add('zoomed'); } 
            else { resetZoomAndPan(); }
            applyTransform();
        };
        
        const updateMinimap = () => {
            const minimapContainer = document.getElementById('minimap-container'), lightboxImage = document.getElementById('lightbox-image'), minimapViewport = document.getElementById('minimap-viewport');
            if (scale <= 1) { minimapContainer.style.display = 'none'; return; }
            minimapContainer.style.display = 'block';
            const imgRect = lightboxImage.getBoundingClientRect(); const containerRect = minimapContainer.getBoundingClientRect();
            const wRatio = containerRect.width / imgRect.width; const hRatio = containerRect.height / imgRect.height;
            minimapViewport.style.width = `${window.innerWidth * wRatio}px`; minimapViewport.style.height = `${window.innerHeight * hRatio}px`;
            minimapViewport.style.left = `${-translatePos.x * wRatio}px`; minimapViewport.style.top = `${-translatePos.y * hRatio}px`;
        };

        const moveImageViaMinimap = (e) => {
            const minimapContainer = document.getElementById('minimap-container'); const mapRect = minimapContainer.getBoundingClientRect();
            const clickX = e.clientX - mapRect.left; const clickY = e.clientY - mapRect.top;
            const percentX = clickX / mapRect.width; const percentY = clickY / mapRect.height;
            const contentWidth = document.getElementById('lightbox-image').offsetWidth * scale; const contentHeight = document.getElementById('lightbox-image').offsetHeight * scale;
            const maxPanX = contentWidth - window.innerWidth; const maxPanY = contentHeight - window.innerHeight;
            translatePos.x = -maxPanX * percentX; translatePos.y = -maxPanY * percentY;
            translatePos.x = Math.max(-maxPanX, Math.min(0, translatePos.x)); translatePos.y = Math.max(-maxPanY, Math.min(0, translatePos.y));
            applyTransform();
        };

        function setupLightboxListeners() {
            const lightboxImage = document.getElementById('lightbox-image');
            const zoomSlider = document.getElementById('zoom-slider');
            const minimapContainer = document.getElementById('minimap-container');
            let isMinimapDragging = false;
            
            document.querySelector('.lightbox-close').addEventListener('click', closeLightbox);
            document.querySelector('.lightbox-next').addEventListener('click', showNextImage);
            document.querySelector('.lightbox-prev').addEventListener('click', showPrevImage);
            document.getElementById('lightbox-content').addEventListener('scroll', () => {
                lightboxEl.classList.toggle('details-view-active', document.getElementById('lightbox-content').scrollTop > 50);
            });
            
            document.getElementById('zoom-in').addEventListener('click', () => updateZoom(scale + 0.5));
            document.getElementById('zoom-out').addEventListener('click', () => updateZoom(scale - 0.5));
            zoomSlider.addEventListener('input', () => updateZoom(parseFloat(zoomSlider.value)));
            lightboxImage.addEventListener('mousedown', e => { if (scale > 1) { isDragging = true; startPos = { x: e.clientX - translatePos.x, y: e.clientY - translatePos.y }; e.preventDefault(); } });
            window.addEventListener('mousemove', e => { if (isDragging) { translatePos.x = e.clientX - startPos.x; translatePos.y = e.clientY - startPos.y; applyTransform(); } });
            window.addEventListener('mouseup', () => { isDragging = false; });
            minimapContainer.addEventListener('mousedown', e => { isMinimapDragging = true; moveImageViaMinimap(e); });
            window.addEventListener('mousemove', e => { if (isMinimapDragging) moveImageViaMinimap(e); });
            window.addEventListener('mouseup', () => { isMinimapDragging = false; });
        }

        // --- Disable Right-Click & Inspect Element ---
        document.addEventListener('keydown', e => {
            if (e.key === 'F12' || (e.ctrlKey && e.shiftKey && ['I', 'J', 'C'].includes(e.key.toUpperCase())) || (e.metaKey && e.altKey && ['I', 'J', 'C'].includes(e.key.toUpperCase())) || (e.ctrlKey && e.key.toUpperCase() === 'U')) {
                e.preventDefault();
            }
        });
    });
    </script>
</body>
</html>
